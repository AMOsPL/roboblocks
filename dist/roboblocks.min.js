/*! roboblocks - v0.0.1 - 2014-09-18
* http://github.com/bq/roboblock
* Copyright (c) 2014 bq; Licensed  */
!function(a){"function"==typeof define&&define.amd?define(["underscore","blockly","blockly.blocks","blockly.lang"],a):a(_,window.Blockly,window.Blocks,window.BlocklyLang)}(function(_,Blockly,Blocks,BlocklyLang){var load=function(options){Blockly.createToolbox=function(){var a={};for(var b in this.Blocks)if(this.Blocks.hasOwnProperty(b)&&this.Blocks[b]instanceof Object&&this.Blocks[b].category){var c=this.Blocks[b].category;a[c]=a[c]||[],a[c].push(b)}var d='<xml id="toolbox" style="display: none">',e=function(a){d+='<block type="'+a+'"></block>'};for(b in a)a.hasOwnProperty(b)&&(d+='<category name="'+b+'">',a[b].forEach(e),d+="</category>");return d+="</xml>"},RoboBlocks.GITHUB_SRC_URL="https://github.com/bq/roboblocks/tree/master/src/";var profiles={arduino:{description:"Standard-compatible board",digital:[["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["10","10"],["11","11"],["12","12"],["13","13"],["A0","A0"],["A1","A1"],["A2","A2"],["A3","A3"],["A4","A4"],["A5","A5"]],bluetooth:[["1","1"],["2","2"],["3","3"],["4","4"],["5","5"],["6","6"],["7","7"],["8","8"],["9","9"],["10","10"],["11","11"]],pwm:[["#3","3"],["#5","5"],["#6","6"],["#9","9"],["#10","10"],["#11","11"]],analog:[["A0","A0"],["A1","A1"],["A2","A2"],["A3","A3"],["A4","A4"],["A5","A5"]],serial:9600},arduino_mega:{description:"Mega-compatible board"}};profiles["default"]=profiles.arduino,this.JST=this.JST||{},this.JST.math_random=function(obj){obj||(obj={});var __p="",__e=_.escape;with(obj)__p+="random("+__e(value_num)+", "+__e(value_dmax)+")";return __p},this.JST.other_random=function(obj){obj||(obj={});var __p="",__e=_.escape;with(obj)__p+="random("+__e(value_num)+", "+__e(value_dmax)+")";return __p},this.JST.servo_cont=function(obj){obj||(obj={});var __p="",__e=_.escape;with(obj)__p+="servo_"+__e(dropdown_pin)+".write("+__e(value_degree)+");\ndelay("+__e(delay_time)+");\n";return __p},this.JST.servo_move=function(obj){obj||(obj={});var __p="",__e=_.escape;with(obj)__p+="servo_"+__e(dropdown_pin)+".write("+__e(value_degree)+");\ndelay("+__e(delay_time)+");\n";return __p};var JST=this.JST;Blockly.Arduino.math_random=function(){var a=Blockly.Arduino.valueToCode(this,"NUM",Blockly.Arduino.ORDER_NONE)||"0",b=Blockly.Arduino.valueToCode(this,"DMAX",Blockly.Arduino.ORDER_ATOMIC)||"10";b=b.replace("(","").replace(")","");var c=JST.math_random({value_num:a,value_dmax:b});return[c,Blockly.Arduino.ORDER_NONE]},Blockly.Blocks.math_random={category:"Math",helpUrl:RoboBlocks.GITHUB_SRC_URL+"blocks/math_random",init:function(){this.appendValueInput("NUM",Number).appendField("Random between").setCheck(Number),this.appendValueInput("DMAX",Number).appendField(" and ").setCheck(Number),this.setInputsInline(!0),this.setOutput(!0),this.setTooltip("Assign a random number")}};var other_random=function(){var a=Blockly.Arduino.valueToCode(this,"NUM",Blockly.Arduino.ORDER_NONE)||"0",b=Blockly.Arduino.valueToCode(this,"DMAX",Blockly.Arduino.ORDER_ATOMIC)||"10";b=b.replace("(","").replace(")","");var c=JST.other_random({value_num:a,value_dmax:b});return[c,Blockly.Arduino.ORDER_NONE]};Blockly.Arduino.other_random=other_random,Blockly.Blocks.other_random={category:"Math",helpUrl:RoboBlocks.GITHUB_SRC_URL+"blocks/other_random",init:function(){this.appendValueInput("NUM",Number).appendField("Random between").setCheck(Number),this.appendValueInput("DMAX",Number).appendField(" and ").setCheck(Number),this.setInputsInline(!0),this.setOutput(!0),this.setTooltip("Assign a random number")}},Blockly.Arduino.servo_cont=function(){var a=this.getTitleValue("PIN"),b=this.getTitleValue("ROT"),c=Blockly.Arduino.valueToCode(this,"DELAY_TIME",Blockly.Arduino.ORDER_ATOMIC)||"10";c=c.replace("(","").replace(")",""),Blockly.Arduino.definitions_.define_servo="#include <Servo.h>\n",Blockly.Arduino.definitions_["var_servo"+a]="Servo servo_"+a+";\n",Blockly.Arduino.setups_["setup_servo_"+a]="servo_"+a+".attach("+a+");\n";var d=JST.servo_cont({dropdown_pin:a,value_degree:b,delay_time:c});return d},Blockly.Blocks.servo_cont={category:"Math",helpUrl:RoboBlocks.GITHUB_SRC_URL+"blocks/servo_cont",init:function(){this.setColour("25"),this.appendDummyInput("").appendField("Servo").appendField(new Blockly.FieldImage("img/blocks/bqmod03.png",208*options.zoom,126*options.zoom)).appendField("PIN#").appendField(new Blockly.FieldDropdown(profiles.default.digital),"PIN").appendField("ROT").appendField(new Blockly.FieldDropdown([["TURN CLOCKWISE","0"],["TURN COUNTERCLOCKWISE","180"],["STOPPED","90"]]),"ROT"),this.appendValueInput("DELAY_TIME",Number).setCheck(Number).setAlign(Blockly.ALIGN_RIGHT).appendField("Delay"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setTooltip("Continuous rotation servo")}},Blockly.Arduino.servo_move=function(){var a=this.getTitleValue("PIN"),b=Blockly.Arduino.valueToCode(this,"DEGREE",Blockly.Arduino.ORDER_ATOMIC);b=b.replace("(","").replace(")","");var c=Blockly.Arduino.valueToCode(this,"DELAY_TIME",Blockly.Arduino.ORDER_ATOMIC)||"10";c=c.replace("(","").replace(")",""),Blockly.Arduino.definitions_.define_servo="#include <Servo.h>\n",Blockly.Arduino.definitions_["var_servo"+a]="Servo servo_"+a+";\n",Blockly.Arduino.setups_["setup_servo_"+a]="servo_"+a+".attach("+a+");\n";var d=JST.servo_move({dropdown_pin:a,value_degree:b,delay_time:c});return d},Blockly.Blocks.servo_move={category:"Math",helpUrl:RoboBlocks.GITHUB_SRC_URL+"blocks/servo_move",init:function(){this.appendDummyInput("").appendField("Servo").appendField(new Blockly.FieldImage("img/blocks/bqmod01.png",208*options.zoom,126*options.zoom)).appendField("PIN#").appendField(new Blockly.FieldDropdown(profiles.default.digital),"PIN"),this.appendValueInput("DEGREE",Number).setCheck(Number).setAlign(Blockly.ALIGN_RIGHT).appendField("Degrees (0~180)"),this.appendValueInput("DELAY_TIME",Number).setCheck(Number).setAlign(Blockly.ALIGN_RIGHT).appendField("Delay"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip("Move between 0~180 degree")}}},RoboBlocks={load:load};return"function"==typeof define&&define.amd?RoboBlocks:void(window.RoboBlocks=RoboBlocks)});